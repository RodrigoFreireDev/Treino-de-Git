# Recuperando commits "perdidos" com Git Reflog

## Objetivo
Aprender a usar o `git reflog` para restaurar commits que pareceram perdidos após operações como `reset`, `rebase` ou exclusão de branches.

---

## O que é o Git Reflog
- Registra todas as alterações feitas nas referências do repositório local (HEAD, branches).
- Diferente do `git log`, inclui eventos destrutivos e movimentos do HEAD.
- Funciona como uma "rede de segurança" para recuperar commits perdidos.

---

## Passo 1: Visualizar o Reflog
```sh
git reflog
````

**Exemplo de saída:**

```
a1b2c3d HEAD@{0}: commit: Adiciona nova funcionalidade
e4f5g6h HEAD@{1}: reset: movendo de b8e6a10 para e4f5g6h
i7j8k9l HEAD@{2}: checkout: movendo de feature-x para master
```

* Cada entrada mostra: `<hash> HEAD@{n}: <ação>`

---

## Passo 2: Identificar o commit a recuperar

* Localize o commit perdido pelo hash ou pelo índice do reflog (ex: `HEAD@{1}`).
* Verifique a descrição para ter certeza que é o commit correto.

---

## Passo 3: Recuperar o commit

### Opção 1: Criar uma nova branch a partir do commit

```sh
git checkout -b recovery-branch <hash-do-commit>
```

Exemplo:

```sh
git checkout -b recovery-branch e4f5g6h
```

* Mantém sua branch atual intacta e cria um branch seguro com os commits perdidos.

### Opção 2: Voltar ao commit perdido com reset

```sh
git reset --hard <hash-do-commit>
```

Exemplo:

```sh
git reset --hard e4f5g6h
```

* Faz sua branch atual apontar diretamente para o commit especificado.
* **Atenção:** descarta alterações locais não commitadas.

### Opção 3: Mesclar o commit perdido em outro branch

```sh
git checkout main
git merge <hash-do-commit>
```

* Permite trazer apenas aquele commit específico sem criar uma branch separada.

---

## Passo 4: Verificar e reincorporar os commits

* Na branch de recuperação:

```sh
git log
```

* Para incorporar em outra branch:

  * **Merge:**

    ```sh
    git checkout main
    git merge recovery-branch
    ```
  * **Cherry-pick (um commit específico):**

    ```sh
    git cherry-pick <hash-do-commit>
    ```

---

## Limitações do Reflog

* **Local:** não é compartilhado com o remoto.
* **Tempo de vida:** entradas expiradas (normalmente 90 dias) são removidas automaticamente.

---

## Exemplo prático

1. Reset inesperado apagou commits:

```sh
git reset --hard HEAD~2
```

2. Exibir reflog:

```sh
git reflog
```

Saída:

```
b8e6a10 HEAD@{0}: reset: movendo de HEAD~2
a1b2c3d HEAD@{1}: commit: Trabalho importante, não apagar!
```

3. Recuperar commit perdido:

```sh
git reset --hard a1b2c3d
```

4. Verificar histórico:

```sh
git log
```

* Commit perdido restaurado com sucesso.
